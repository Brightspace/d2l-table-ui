<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="d2l-table-wrapper.html">
<link rel="import" href="d2l-table-col-sort.html">

<!--
# D2L Table

## Usage
```
	<link rel="import" href="d2l-table.html">
	<table is="d2l-table">
		<thead>
			<tr>
				<th>Table header cell</th>
			</tr>
		</thead>
		<tfoot>
			<tr>
				<th>Table header cell</th>
			</tr>
		</tfoot>
		<tbody>
			<tr>
				<td>Table cell</td>
			</tr>
		</tbody>
	</table>
```

## TODO

When ShadowDOM v1 is available, use `<slot>` and `::slotted`. This may affect the interface

@demo demo/index.html      Table demo
@demo demo/index.rtl.html  RTL Table demo
@demo demo/responsive.html Identical tables with different widths
-->
<dom-module id="d2l-table">
	<template>
		<content></content>
	</template>
	<script>
		Polymer({
			is: 'd2l-table',
			extends: 'table',
			properties: {
				wrapper: {
					type: Object,
					readOnly: true,
					value: null
				}
			},
			wrapMe: function() {
				var parentNode = Polymer.dom(this).parentNode;
				if (parentNode && parentNode.tagName && parentNode.tagName.toUpperCase() === 'D2L-TABLE-WRAPPER') { // The table already is in a wrapper
					this._setWrapper(parentNode);
				} else if (parentNode && !this.wrapper) { // The table is mounted but doesn't have a wrapper. Create it
					var wrapper = document.createElement('d2l-table-wrapper');
					Polymer.dom(parentNode).replaceChild(wrapper, this);
					Polymer.dom(wrapper).appendChild(this);
					Polymer.dom.flush();
				}
			},
			attached: function() {
				this.wrapMe();
			},
			detached: function() {
				if (this.wrapper && Polymer.dom(this.wrapper).parentNode) {
					Polymer.dom(Polymer.dom(this.wrapper).parentNode).removeChild(this.wrapper);
					Polymer.dom.flush();
					this._setWrapper(null);
				}
			}
		});
	</script>
</dom-module>
